function checkModifiedLine(b,a){if(b.value==undefined){if(a<b.length){b[a].checked=true}}else{if(a==0){b.checked=true}}}function unselectall(){if(document.getElementById("myCheckBoxAll").checked){document.getElementById("myCheckBoxAll").checked=document.getElementById("myCheckBoxAll").checked&0}}function selectall(c,b){document.getElementById("myCheckBoxAll").checked=document.getElementById("myCheckBoxAll").checked|0;if(b==0){return}if(b==1){c.selectedItemIdx.checked=document.getElementById("myCheckBoxAll").checked}if(b>1){for(var a=0;a<b;a++){c.selectedItemIdx[a].checked=document.getElementById("myCheckBoxAll").checked}}}function doSubmit(b,c,a){b.range.value=a;b.start.value=c;b.submit()}function setIndex(b,a){b.start.value=a;b.submit()}function changeControlValue(b,a){b.value=a}function reOrder(a,b){if(a.elements["order/columns"].value==b){if(a.elements["order/asc"].value=="true"){a.elements["order/asc"].value="false"}else{a.elements["order/asc"].value="true"}}else{a.elements["order/columns"].value=b}setIndex(a,1)}function createReport(a){changeControlValue(a.resulthandler,"/html/nds/reports/create_report.jsp");a.submit()}function checkModifiedLine(b,a){if(b.value==undefined){if(a<b.length){b[a].checked=true}}else{if(a==0){b.checked=true}}}function inputChanged(d,a){var c=d.split("_");if(c.length<3){alert("id()"+d+" has error!");return}var b=c[1];checkModifiedLine(document.sheet_item_modify.selectedItemIdx,b)}function checkboxChanged(b,a){document.getElementById(b).value=(document.getElementById("chk_"+b).checked?"Y":"N");alert(document.getElementById(b).value);inputChanged(b,a)}function changeFocusOnCell(e,b){var a="column_"+e+"_"+b;var d=document.getElementById([a]);try{if(d!=null){d.focus()}}catch(c){var d=document.getElementById(["chkn_"+a]);try{if(d!=null){d.focus()}}catch(c){}}}function move(g,c){var f=g.split("_");if(f.length<3){alert("id()"+g+" has error!");return}var d=f[1];var b=f[2];switch(c.keyCode){case 37:var a=document.getElementById(g);if(a.type=="text"&&a.value.length>0){return}b--;changeFocusOnCell(d,b);break;case 38:d--;changeFocusOnCell(d,b);break;case 39:var a=document.getElementById(g);if(a.value.length>0){return}b++;changeFocusOnCell(d,b);break;case 40:case 13:d++;changeFocusOnCell(d,b);break;default:if(c.keyCode!=9&&c.keyCode!=16){checkModifiedLine(document.sheet_item_modify.selectedItemIdx,d)}}}function refresh(a){a.submit()}function openScript(d){var a=420,b=500;var c=window.open(d,"FlinkWindow","width="+a+",height="+b+",dependent=yes,resizable=1,scrollbars=yes,menubar=no,status=yes");c.focus()}function addKeyCatcher(c,a){if(a.elements.length==0){return true}_Frame=c;_Form=a;for(var b=0;b<a.elements.length;b++){a.elements[b].onkeypress=keyCatcher}keyCatcher(true)}function keyCatcher(g){var f;var c;if(g){f=13;c=_Form.elements[_Form.elements.length-1]}else{f=_Frame.window.event.keyCode;c=_Frame.window.event.srcElement;if(isReservedKeycode(f)){return false}if(f==27){_Frame.window.event.srcElement.blur();_Frame.window.event.srcElement.focus();return true}if(_Frame.window.event.srcElement.type.toUpperCase()=="TEXTAREA"){return true}}if(f!=13){return true}for(var d=0,b=-1;;){if(_Form.elements[d]==c){if(b==d){return true}b=d}if(d==(_Form.elements.length-1)){d=0}else{d++}if(b==-1){continue}var e=_Form.elements[d];if(e.tagName.toUpperCase()=="FIELDSET"){continue}if(!isDisplay(e)){continue}var h=e.type.toUpperCase();if(h=="HIDDEN"||h=="BUTTON"||h=="SUBMIT"||h=="RESET"){continue}var a=(h=="TEXT"||h=="PASSWORD"||h=="TEXTAREA");if(a&&e.readOnly){continue}if(e.disabled){continue}if(e.name!="T8"){continue}if(a){e.select()}e.focus();return false}}function isDisplay(a){if(a.tagName=="INPUT"&&a.type=="hidden"){return false}while(a.tagName!="BODY"&&a.style.display!="none"){a=a.parentElement}if(a.tagName=="BODY"){return true}else{return false}}function isReservedKeycode(a){switch(a){case 39:case 94:case 96:case 124:return true}return false}function doAction(a){a.method="post";a.submit()}function makeArray(b){for(var a=1;a<=b;a++){this[a]=0}return this}function isEmpty(a){return((a==null)||(a.length==0))}function isWhitespace(b){var a;if(isEmpty(b)){return true}for(a=0;a<b.length;a++){var d=b.charAt(a);if(" ".indexOf(d)==-1){return false}}return true}function stripCharsInBag(d,e){var b;var a="";for(b=0;b<d.length;b++){var f=d.charAt(b);if(e.indexOf(f)==-1){a+=f}}return a}function stripCharsNotInBag(d,e){var b;var a="";for(b=0;b<d.length;b++){var f=d.charAt(b);if(e.indexOf(f)!=-1){a+=f}}return a}function stripWhitespace(a){return stripCharsInBag(a,whitespace)}function charInString(b,a){for(i=0;i<a.length;i++){if(a.charAt(i)==b){return true}}return false}function stripInitialWhitespace(b){var a=0;while((a<b.length)&&charInString(b.charAt(a),whitespace)){a++}return b.substring(a,b.length)}function isLetter(a){return(((a>="a")&&(a<="z"))||((a>="A")&&(a<="Z")))}function isDigit(a){return((a>="0")&&(a<="9"))}function isLetterOrDigit(a){return(isLetter(a)||isDigit(a))}function isInteger(b){var a;if(isEmpty(b)){if(isInteger.arguments.length==1){return defaultEmptyOK}else{return(isInteger.arguments[1]==true)}}for(a=0;a<b.length;a++){var d=b.charAt(a);if(!isDigit(d)){return false}}return true}function isSignedInteger(c){if(isEmpty(c)){if(isSignedInteger.arguments.length==1){return defaultEmptyOK}else{return(isSignedInteger.arguments[1]==true)}}else{var b=0;var a=defaultEmptyOK;if(isSignedInteger.arguments.length>1){a=isSignedInteger.arguments[1]}if((c.charAt(0)=="-")||(c.charAt(0)=="+")){b=1}return(isInteger(c.substring(b,c.length),a))}}function isPositiveInteger(b){var a=defaultEmptyOK;if(isPositiveInteger.arguments.length>1){a=isPositiveInteger.arguments[1]}return(isSignedInteger(b,a)&&((isEmpty(b)&&a)||(parseInt(b)>0)))}function isNonnegativeInteger(b){var a=defaultEmptyOK;if(isNonnegativeInteger.arguments.length>1){a=isNonnegativeInteger.arguments[1]}return(isSignedInteger(b,a)&&((isEmpty(b)&&a)||(parseInt(b)>=0)))}function isNegativeInteger(b){var a=defaultEmptyOK;if(isNegativeInteger.arguments.length>1){a=isNegativeInteger.arguments[1]}return(isSignedInteger(b,a)&&((isEmpty(b)&&a)||(parseInt(b)<0)))}function isNonpositiveInteger(b){var a=defaultEmptyOK;if(isNonpositiveInteger.arguments.length>1){a=isNonpositiveInteger.arguments[1]}return(isSignedInteger(b,a)&&((isEmpty(b)&&a)||(parseInt(b)<=0)))}function isFloat(d){var b;var a=false;if(isEmpty(d)){if(isFloat.arguments.length==1){return defaultEmptyOK}else{return(isFloat.arguments[1]==true)}}if(d==decimalPointDelimiter){return false}for(b=0;b<d.length;b++){var e=d.charAt(b);if((e==decimalPointDelimiter)&&!a){a=true}else{if(!isDigit(e)){return false}}}return true}function isSignedFloat(c){if(isEmpty(c)){if(isSignedFloat.arguments.length==1){return defaultEmptyOK}else{return(isSignedFloat.arguments[1]==true)}}else{var b=0;var a=defaultEmptyOK;if(isSignedFloat.arguments.length>1){a=isSignedFloat.arguments[1]}if((c.charAt(0)=="-")||(c.charAt(0)=="+")){b=1}return(isFloat(c.substring(b,c.length),a))}}function isAlphabetic(b){var a;if(isEmpty(b)){if(isAlphabetic.arguments.length==1){return defaultEmptyOK}else{return(isAlphabetic.arguments[1]==true)}}for(a=0;a<b.length;a++){var d=b.charAt(a);if(!isLetter(d)){return false}}return true}function isAlphanumeric(b){var a;if(isEmpty(b)){if(isAlphanumeric.arguments.length==1){return defaultEmptyOK}else{return(isAlphanumeric.arguments[1]==true)}}for(a=0;a<b.length;a++){var d=b.charAt(a);if(!(isLetter(d)||isDigit(d))){return false}}return true}function isEmail(b){if(isEmpty(b)){if(isEmail.arguments.length==1){return defaultEmptyOK}else{return(isEmail.arguments[1]==true)}}if(isWhitespace(b)){return false}var a=1;var c=b.length;while((a<c)&&(b.charAt(a)!="@")){a++}if((a>=c)||(b.charAt(a)!="@")){return false}else{a+=2}while((a<c)&&(b.charAt(a)!=".")){a++}if((a>=c-1)||(b.charAt(a)!=".")){return false}else{return true}}function isURL(a){if(isEmpty(a)){if(isURL.arguments.length==1){return defaultEmptyOK}else{return(isURL.arguments[1]==true)}}if(isWhitespace(a)){return false}a=a.toLowerCase();if(a.indexOf("http://www")==-1){return false}else{return true}}function isYear(a){if(isEmpty(a)){if(isYear.arguments.length==1){return defaultEmptyOK}else{return(isYear.arguments[1]==true)}}if(!isNonnegativeInteger(a)){return false}return((a.length==2)||(a.length==4))}function isIntegerInRange(f,d,c){if(isEmpty(f)){if(isIntegerInRange.arguments.length==1){return defaultEmptyOK}else{return(isIntegerInRange.arguments[1]==true)}}if(!isInteger(f,false)){return false}var e=parseInt(f,10);return((e>=d)&&(e<=c))}function isMonth(a){if(isEmpty(a)){if(isMonth.arguments.length==1){return defaultEmptyOK}else{return(isMonth.arguments[1]==true)}}return isIntegerInRange(a,1,12)}function isDay(a){if(isEmpty(a)){if(isDay.arguments.length==1){return defaultEmptyOK}else{return(isDay.arguments[1]==true)}}return isIntegerInRange(a,1,31)}function daysInFebruary(a){return(((a%4==0)&&((!(a%100==0))||(a%400==0)))?29:28)}function isDate(b,e,a){if(!(isYear(b,false)&&isMonth(e,false)&&isDay(a,false))){return false}var c=parseInt(b,10);var d=parseInt(e,10);var f=parseInt(a,10);if(f>daysInMonth[d]){return false}if((d==2)&&(f>daysInFebruary(c))){return false}return true}function checkEmail(a,b){if(checkEmail.arguments.length==1){b=defaultEmptyOK}if((b==true)&&(isEmpty(a.value))){return true}else{if(!isEmail(a.value,false)){return warnInvalid(a,iEmail)}else{return true}}}function checkYear(a,b){if(checkYear.arguments.length==1){b=defaultEmptyOK}if((b==true)&&(isEmpty(a.value))){return true}if(!isYear(a.value,false)){return warnInvalid(a,iYear)}else{return true}}function checkMonth(a,b){if(checkMonth.arguments.length==1){b=defaultEmptyOK}if((b==true)&&(isEmpty(a.value))){return true}if(!isMonth(a.value,false)){return warnInvalid(a,iMonth)}else{return true}}function checkDay(a,b){if(checkDay.arguments.length==1){b=defaultEmptyOK}if((b==true)&&(isEmpty(a.value))){return true}if(!isDay(a.value,false)){return warnInvalid(a,iDay)}else{return true}}function checkDate(a,c,e,b,d){if(checkDate.arguments.length==4){d=false}if(!isYear(a.value)){return warnInvalid(a,iYear)}if(!isMonth(c.value)){return warnInvalid(c,iMonth)}if((d==true)&&isEmpty(e.value)){return true}else{if(!isDay(e.value)){return warnInvalid(e,iDay)}}if(isDate(a.value,c.value,e.value)){return true}alert(iDatePrefix+b+iDateSuffix);return false}function LeapYear(a){if(a%100==0){if(a%400==0){return true}}else{if((a%4)==0){return true}}return false};